:root {
  --bg: #0b0d10;
  --panel: rgba(0, 0, 0, 0.45);
  --border: rgba(255, 255, 255, 0.12);
  --border2: rgba(255, 255, 255, 0.22);
  --fg: rgba(255, 255, 255, 0.95);
  --muted: rgba(255, 255, 255, 0.65);
  --accent: #69f0ae;
  --warn: #ffcc66;
  --danger: #ff5566;
  --font-stack:
    "Inter", ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto,
    Helvetica, Arial, sans-serif;
  --glass: blur(16px);
  --glow-shadow: 0 0 20px rgba(105, 240, 174, 0.4);
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  background-color: var(--bg);
  color: var(--fg);
  font-family: var(--font-stack);
  overflow-x: hidden;
}

.app-container {
  min-height: 100vh;
  padding: 24px;
  display: grid;
  grid-template-columns: 340px 1fr;
  gap: 20px;
  max-width: 1600px;
  margin: 0 auto;
  animation: fadeIn 0.8s ease-out forwards;
}

@media (max-width: 1024px) {
  .app-container {
    grid-template-columns: 1fr;
    padding: 16px;
  }

  .left-panel {
    order: 2;
  }

  .canvas-wrapper {
    order: 1;
    width: 100%;
    margin-bottom: 20px;
  }
}

.mobile-only {
  display: none;
}

@media (max-width: 600px) {
  .desktop-only {
    display: none !important;
  }

  .mobile-only {
    display: flex !important;
  }

  .app-container {
    padding: 0;
    margin: 0;
    width: 100vw;
    height: 100vh;
    background: #000; /* Phone Frame Body */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
  }

  /* 1) PHONE FRAME (Implicitly the screen, but we enforce boundaries) */

  /* 2) GREEN STAGE (Center) */
  .canvas-wrapper {
    position: relative;
    width: 90vw;
    aspect-ratio: 9/16;
    max-height: 80vh;
    margin: 0 auto;
    border: 2px solid #69f0ae; /* Green Stage Border */
    box-shadow: 0 0 20px rgba(105, 240, 174, 0.2);
    border-radius: 4px;
    z-index: 10;
    background: #000;
    overflow: hidden;
    order: 2; /* Visual Order */
    flex-shrink: 0;
  }

  .canvas-wrapper.active {
    border-color: #69f0ae;
    box-shadow: 0 0 30px rgba(105, 240, 174, 0.4);
  }

  /* 3) LEFT TOOLBAR */
  .left-panel {
    display: contents; /* flattened */
  }

  .card.corner-tl,
  .card.corner-bl {
    /* We repurpose these or create a new container in App.tsx? */
    /* Actually better to use absolute positioning relative to phone frame */
    /* But current HTML structure is: LeftPanel > Cards */
    /* We need to break them out visually */
  }

  /* We need a specific "Left Toolbar" container. 
     Since HTML structure is rigid, we'll use absolute positioning on the specific ID/Classes 
     assuming they are identifiable. */

  /* Repositioning the "Tools" card content */
  .corner-tl {
    position: absolute;
    left: 10px;
    top: 50%;
    transform: translateY(-50%);
    width: 50px;
    padding: 0;
    background: transparent;
    border: none;
    box-shadow: none;
    backdrop-filter: none;
    z-index: 20;
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .corner-tl .label-row,
  .corner-tl .btn-danger {
    display: none;
  }

  .corner-tl div[style*="grid"] {
    display: flex !important;
    flex-direction: column;
    gap: 16px !important;
  }

  /* Specific buttons in left toolbar */
  .corner-tl .btn {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: #111;
    border: 1px solid #333;
    padding: 0;
  }

  /* Eraser toggle (in corner-bl normally) -> moved to Left Toolbar visually? 
     Or keep it bottom left? Layout says "Left Vertical Toolbar".
     We might need to move Eraser into the same visual stack. 
     For now, let's put corner-bl at the bottom of the left stack. 
  */
  .corner-bl {
    position: absolute;
    left: 10px;
    top: calc(50% + 140px); /* Offset from top stack */
    width: 50px;
    padding: 0;
    background: transparent;
    border: none;
    box-shadow: none;
    z-index: 20;
  }
  .corner-bl div {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }
  .corner-bl .btn {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    padding: 0;
    font-size: 0; /* Hide text "Eraser Mode" */
  }
  .corner-bl .btn::after {
    content: "E"; /* Fallback icon or SVG? SVG is inside. */
    font-size: 14px;
    color: #fff;
  }

  /* 4) RIGHT SOCIAL STACK */
  /* corner-tr is usually "Camera Swap" and "Mic" */
  /* We want Social Stack on Right. current HTML has social in "desktop-only" card.
     Wait, the user said "Right Vertical Social Stack". 
     The current `desktop-only` card with social icons is HIDDEN on mobile.
     We must UN-HIDE it for mobile but styling it differently.
  */

  /* We need to target the social card. It doesn't have a unique class in `App.tsx` other than order. 
     We might need to add a class in App.tsx first. 
     BUT, if we can't edit App.tsx HTML structure easily for this, we might be stuck.
     Actually I can modify App.tsx to add `className="social-stack mobile-visible"` etc.
  */

  /* 5) BOTTOM CONTROLS */
  /* Swap Camera (bottom-left) & Save As (bottom-right) */

  .corner-tr {
    /* Camera Swap & Mic are here. 
       User wants: Bottom-Left = Swap Camera. 
       Mic isn't specified but needed.
       Save As (floppy) = Bottom-Right.
    */
    position: absolute;
    bottom: 30px;
    left: 20px;
    top: auto;
    right: auto;
    width: auto;
    background: transparent;
    border: none;
    padding: 0;
    box-shadow: none;
    z-index: 20;
    display: flex;
    gap: 20px;
  }
  .corner-tr .btn {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background: #222;
    border: 1px solid #444;
  }

  .corner-br {
    /* Save As */
    position: absolute;
    bottom: 30px;
    right: 20px;
    top: auto;
    left: auto;
    width: auto;
    background: transparent;
    border: none;
    padding: 0;
    box-shadow: none;
    z-index: 20;
  }
  .corner-br .btn {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background: #69f0ae;
    color: #000;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
  }
  .corner-br .btn svg {
    stroke: #000;
  }
  /* Hide "Share" usage in corner-br if it exists, only "Save/Export" is needed there? 
     User said "Bottom-right: Save As".
  */

  /* 6) TENSOR INDICATOR */
  .tensor-status-container {
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 30;
  }
  .tensor-indicator {
    width: 12px;
    height: 12px;
    background: #223;
    border: 2px solid #334;
    border-radius: 50%;
    transition: all 0.2s;
  }
  .tensor-indicator.speaking {
    background: #69f0ae;
    box-shadow: 0 0 15px #69f0ae;
    transform: scale(1.5);
  }
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.left-panel {
  display: flex;
  flex-direction: column;
  gap: 16px;
  z-index: 10;
}

.card {
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 20px;
  padding: 16px;
  backdrop-filter: var(--glass);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.card:hover {
  border-color: var(--border2);
  transform: translateY(-2px);
  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
}

.btn {
  padding: 12px 16px;
  border-radius: 14px;
  border: 1px solid var(--border);
  background: rgba(255, 255, 255, 0.05);
  color: var(--fg);
  cursor: pointer;
  font-weight: 700;
  font-family: var(--font-stack);
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  outline: none;
}

.btn:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: var(--border2);
  transform: scale(1.02);
}

.btn:active {
  transform: scale(0.98);
}

.btn-primary {
  background: rgba(105, 240, 174, 0.15);
  border-color: rgba(105, 240, 174, 0.3);
  color: var(--accent);
}

.btn-primary:hover {
  background: rgba(105, 240, 174, 0.25);
  border-color: var(--accent);
  box-shadow: var(--glow-shadow);
}

.btn-danger {
  background: rgba(255, 85, 102, 0.1);
  border-color: rgba(255, 85, 102, 0.2);
  color: var(--danger);
}

.btn-danger:hover {
  background: rgba(255, 85, 102, 0.2);
  border-color: var(--danger);
}

.label-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  color: var(--muted);
  font-size: 13px;
  margin-bottom: 8px;
}

.canvas-wrapper {
  position: relative;
  border: 1px solid var(--border);
  border-radius: 24px;
  overflow: hidden;
  background: rgba(255, 255, 255, 0.02);
  box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
  transition: border-color 0.5s ease;
}

.canvas-wrapper.active {
  border-color: var(--accent);
}

.video-layer {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: fill;
  transform: scaleX(-1);
  filter: brightness(0.8) contrast(1.1);
}

.canvas-layer {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  transform: scaleX(-1);
  object-fit: fill;
}

/* Animations & Transitions */

.opening-overlay {
  position: fixed;
  inset: 0;
  background: var(--bg);
  z-index: 1000;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  animation: fadeOutOverlay 1s ease-in 2.5s forwards;
  pointer-events: none;
}

@keyframes fadeOutOverlay {
  to {
    opacity: 0;
    visibility: hidden;
  }
}

.nova-logo {
  width: 120px;
  height: 120px;
  border: 8px solid var(--accent);
  border-radius: 50%;
  position: relative;
  animation: logoPulse 2s infinite ease-in-out;
  box-shadow: var(--glow-shadow);
}

.nova-overlay {
  position: absolute;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 20;
  pointer-events: none;
}

.nova-indicator {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  background: rgba(105, 240, 174, 0.2);
  border: 2px solid var(--accent);
  position: relative;
  transition: all 0.3s ease;
  box-shadow: 0 0 15px rgba(105, 240, 174, 0.3);
}

.nova-indicator::after {
  content: "";
  position: absolute;
  inset: -4px;
  border-radius: 50%;
  border: 1px solid var(--accent);
  opacity: 0;
}

.nova-indicator.speaking {
  background: var(--accent);
  box-shadow:
    0 0 30px var(--accent),
    0 0 60px var(--accent);
  animation: novaPulse 0.5s infinite alternate;
}

.nova-indicator.speaking::after {
  animation: novaRipple 1.2s infinite ease-out;
}

@keyframes novaPulse {
  from {
    transform: scale(1);
    opacity: 0.8;
  }
  to {
    transform: scale(1.15);
    opacity: 1;
  }
}

@keyframes novaRipple {
  0% {
    transform: scale(1);
    opacity: 0.8;
    border-width: 2px;
  }
  100% {
    transform: scale(2);
    opacity: 0;
    border-width: 0px;
  }
}

@keyframes logoPulse {
  0% {
    transform: scale(1);
    box-shadow: 0 0 20px var(--accent);
  }
  50% {
    transform: scale(1.1);
    box-shadow: 0 0 50px var(--accent);
  }
  100% {
    transform: scale(1);
    box-shadow: 0 0 20px var(--accent);
  }
}

.instructions-modal {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.9);
  width: 90%;
  max-width: 500px;
  background: rgba(11, 13, 16, 0.95);
  border: 1px solid var(--accent);
  border-radius: 24px;
  padding: 32px;
  z-index: 100;
  opacity: 0;
  visibility: hidden;
  transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  backdrop-filter: blur(20px);
}

.instructions-modal.open {
  opacity: 1;
  visibility: visible;
  transform: translate(-50%, -50%) scale(1);
}

.modal-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(4px);
  z-index: 99;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease;
}

.modal-backdrop.open {
  opacity: 1;
  visibility: visible;
}

/* Scrollbar */
::-webkit-scrollbar {
  width: 6px;
}
::-webkit-scrollbar-track {
  background: transparent;
}
::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 10px;
}
::-webkit-scrollbar-thumb:hover {
  background: var(--border2);
}
